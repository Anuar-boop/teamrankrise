services:
  - type: web
    name: rankrise-audit-backend
    runtime: node
    plan: free
    buildCommand: npm install
    startCommand: npm start
    envVars:
      - key: NODE_ENV
        value: production
      - key: PORT
        value: 3000
      - key: MAX_CONCURRENT
        value: 2
      - key: RATE_LIMIT_PER_IP
        value: 10
    headers:
      - path: "/*"
        name: "Access-Control-Allow-Origin"
        value: "https://teamrankrise.com"
      - path: "/*"
        name: "Access-Control-Allow-Methods"
        value: "GET, POST, OPTIONS"
      - path: "/*"
        name: "Access-Control-Allow-Headers"
        value: "Content-Type"

  - type: static_site
    name: rankrise-website
    buildCommand: echo "Static site - no build needed"
    staticPublishPath: ./
    headers:
      - path: "/*"
        name: "Cache-Control"
        value: "no-cache, no-store, must-revalidate, max-age=0, public"
      - path: "/*"
        name: "Pragma"
        value: "no-cache"
      - path: "/*"
        name: "Expires"
        value: "0"
      - path: "/*"
        name: "X-Cache-Version"
        value: "rankrise-v2.1-mobile-fixes-live"
      - path: "/*"
        name: "X-Deployed-At"
        value: "2026-02-16T08:50:00Z"
      - path: "/*.html"
        name: "Content-Type"
        value: "text/html; charset=utf-8"
      - path: "/free-audit.html"
        name: "Cache-Control"
        value: "no-cache, no-store, must-revalidate, max-age=0"
    routes:
      - path: /api/*
        destination: rankrise-audit-backend
